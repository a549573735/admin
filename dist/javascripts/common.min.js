function Common(t){this.obj=$(t),this.uiInit={$lHtml:jQuery("html"),$lBody:jQuery("body"),$lhead:jQuery("#c-header"),$lMain:jQuery("#c-content"),$lFooter:jQuery("#c-footer"),$lUMessage:jQuery("#u-message"),$lUserBtn:jQuery("#u-btn"),$lDate:jQuery(".input-daterange").add(".js-datepicker"),$lMinModal:jQuery(".v-modal-min"),$lMinBtn:jQuery(".v-min-toggle"),$lNav:jQuery(".c-list"),$appKeyBtn:jQuery("#appkey-btn"),$againSecret:jQuery("#again_secret")},this.regIphone=/^1\d{10}$/i,this.regEmail=/^(\w)+(\.\w+)*@(\w)+((\.\w{2,3}){1,3})$/,this.listDown(),this.contentHeight(),this.userMessage(),this.inputDate(),this.minModal(),this.setNavActive(),this.sendMessage(".suggestion-btn","#tables","#val-suggestion",null,"/api/suggestion/msg",null,".v-modal-min",".v-msg",".park-belongId_s"),this.sendMessage(".interview-btn","#tables","#val-interview","#select-interview","/api/interview/msg",null,".v-modal-min",".v-msg",".park-belongId_iv"),this.sendMessage(".appointment-btn","#tables","#val-appointment",null,"/api/appointment/msg","#date-appointment",".v-modal-min",".v-msg",".park-belongId_ap"),this.sendMessage(".inspect-qualified-btn","#tables","#val-qualified",null,"/api/inspect/qualified/msg",null,".v-modal-min",".v-msg",".park-belongId_it"),this.sendMessage(".inspect-qualified-btn2","#tables",null,null,"/api/inspect/qualified/msg",null,null,null,null),this.getAppkey(),this.againSecret(),this.addParty(),this.setPassword(".model-password-btn"),this.EmptyInput(["#modal-addParty","#modal-addCompany"]),this.uiInit.$lMinBtn.attr("bclick",!1),this.setFormDate()}Common.prototype.listDown=function(t){this.obj.on("click",function(){$(this).next().hasClass("open")?($(this).find("i").attr("class","icon-caret-right"),$(this).next().removeClass("open")):($(this).find("i").attr("class","icon-caret-down"),$(this).next().addClass("open"))})},Common.prototype.contentHeight=function(){var t=jQuery(window).height(),e=this.uiInit.$lhead.outerHeight(),n=this.uiInit.$lFooter.outerHeight(),a=this.uiInit.$lMain.outerHeight();if(a+e+n<t){var i=t-n-e;this.uiInit.$lMain.css({"min-height":i-50,"margin-bottom":"50px"})}this.uiInit.$lMain.css({"margin-bottom":"50px"}),this.uiInit.$lFooter.css("visibility","inherit")},Common.prototype.userMessage=function(){this.uiInit.$lUserBtn.on("click",function(){this.bclick=!this.bclick,$.get("/user/verify").then(function(t){console.log(t),$(".sm_dian").html(t.content.messageCount)}),this.bclick?$(this).next().show():$(this).next().hide()})},Common.prototype.inputDate=function(){this.uiInit.$lDate.datepicker({language:"zh-CN",weekStart:1,autoclose:!0,todayHighlight:!0,format:"yyyy-mm-dd"})},Common.prototype.minModal=function(){this.uiInit.$lMinBtn.on("click",function(){var t=this;$(this).parent().siblings(".v-item-btn").children(".v-modal-min").hide(),$(this).parent().siblings(".v-item-btn").children(".v-min-toggle").attr("bclick",!1),$(this).closest(".v-item-btn").find(".v-msg").hide(),$(this).closest(".v-item-btn").find("textarea").val(""),"false"==$(this).attr("bclick")?($(this).next().show().animate({opacity:"1"}),$(t).attr("bclick",!0)):$(this).next().animate({opacity:"0"},function(){$(this).hide(),$(t).attr("bclick",!1)})})},Common.prototype.setNavActive=function(){var t=window.location.pathname,e=(window.location.search,$.query.get("view"));"/user/admin/add"==t?t="/user/edit/list":e?t="/organize/company":"/user/add"==t&&(t="/user/role/list"),this.uiInit.$lNav.find("li a").each(function(e,n){$(n).attr("href").split("?")[0]==t&&($(n).addClass("active"),"LI"!==$(n).parent()[0].tagName&&($(n).parent().parent().prev().find("i").attr("class","icon-caret-down"),$(n).parent().parent().addClass("open")))})},Common.prototype.sendMessage=function(t,e,n,a,i,o,s,r,l){$(t).on("click",function(){var t=$.query.get("id"),c="COMPANY",d=[];$(e).find("input[type=checkbox]:checked").each(function(t,e){d.push($(e).val())});var m=$(e).find("input[type=checkbox]:checked").attr("data-type"),p={suggestion:$(n).val(),target:d.length>0?d:t,type:m?m:c,period:$(a).val(),inspectDate:$(o).val(),notes:$(n).val(),status:$(this).attr("data-status"),ccPark:!!$(l).prop("checked")},h=this;$.post(i,p).then(function(t){t.success?($(h).closest(s).find(r).html("提交成功").show(),$(h).closest(".v-modal-min").hide().prev().attr("bclick","false"),alert("提交成功")):($(h).closest(s).find(r).html(t.errMessage).show(),alert("提交失败"+t.errMessage))})})},Common.prototype.addZero=function(t){return t=t>9?t:"0"+t},Common.prototype.setForm=function(){var t=new Date,e=t.getFullYear()+"-"+this.addZero(t.getMonth())+"-"+this.addZero(t.getDate()),n=t.getFullYear()+"-"+this.addZero(t.getMonth()+1)+"-"+this.addZero(t.getDate());return{from:e,to:n}},Common.prototype.getAppkey=function(){this.uiInit.$appKeyBtn.on("click",function(){$.get("/api/app/company/appKey").then(function(t){$(".appkey").html(t.content.appKey),$(".secret").html(t.content.secret)})})},Common.prototype.againSecret=function(){this.uiInit.$againSecret.on("click",function(){$.get("/api/app/company/secret/generate").then(function(t){$(".secret").html(t.content)})})},Common.prototype.addParty=function(t){var e=this;$(".admin-add-btn").on("click",function(){var t={parentId:"all"==$(".select_park").val()?"":$(".select_park").val(),name:$(".admin-name").val(),phone:$(".admin-phone").val(),contact:$(".admin-contact").val(),address:$(".admin-address").val(),username:$(".admin-username").val(),mail:$(".admin-email").val(),id:$(".admin-id").val(),admin:$(".admin-admin").val()};void 0==t.parentId&&(t.parentId="ROOT");var n=e.checkEmpty($(this).closest(".form_Party").find("input[type=text]")),a=e.checkEmpty($(this).closest(".form_Party").find(".admin-email"));return"false"==n.state?(alert(n.message),!1):"false"==a.state?(alert(a.message),!1):void("modify"==$(".admin-type").val()?$.post("/admin/organize/modify",t).then(function(t){t.success?($(".admin-contact").val(""),$(".admin-phone").val(""),$(".admin-address").val(""),$(".admin-name").val(""),$(".admin-email").val(""),$(".admin-username").val(""),$(".admin-admin").val(""),$(".admin-id").val(""),alert("修改成功")):alert(t.errMessage)}):$.post("/api/organize/add",t).then(function(t){t.success?($(".admin-contact").val(""),$(".admin-phone").val(""),$(".admin-address").val(""),$(".admin-name").val(""),$(".admin-email").val(""),$(".admin-username").val(""),$(".admin-admin").val(""),$(".admin-id").val(""),alert("添加成功")):alert(t.errMessage)}))})},Common.prototype.checkEmpty=function(t){var e=0;return $.each(t,function(t,n){""==$(n).val()&&e++}),0!=e?{message:"输入框不能为空",state:"false"}:{message:"",state:"true"}},Common.prototype.checkEmail=function(t){return this.regEmail.test(t.val())?{message:"",state:"true"}:{message:"您输入的邮箱有误,请重新输入",state:"false"}},Common.prototype.checkIphone=function(t){return this.regIphone.test(t.val())?{message:"",state:"true"}:{message:"您输入的手机有误,请重新输入",state:"false"}},Common.prototype.countdown=function(t){t.attr("disabled","disabled");var e=60,n=null;clearInterval(n),n=setInterval(function(){return e--,e<0?(clearInterval(n),t.removeAttr("disabled").html("重新发送"),t.css({cursor:"pointer"}),!1):(e<10&&(e="0"+e),void t.html(e+"秒"))},1e3)},Common.prototype.setPassword=function(t){$(t).on("click",function(){var t=this,e={newPassword:$("#new-password").val(),oldPassword:$("#old-password").val()};$.post("/put/user/password",e).then(function(e){e.success?($(t).parent().next().show().html("密码修改成功"),setTimeout(function(){$("#modal-password").modal("toggle"),$(t).parent().next().hide()},1500)):$(t).parent().next().show().html(e.errMessage)})})},Common.prototype.getChecked=function(){var t=[],e=$.query.get("name"),n=$.query.get("permissionIds").toString();$(".per_name").val(e),n.indexOf(",")!=-1?t=$.query.get("permissionIds").split(","):t.push(n),""!=t&&t.forEach(function(t){$(".rolt-user-checked").find("input[type=checkbox]").each(function(e,n){$(n).attr("data-id")==t&&$(n).prop("checked","checked")})})},Common.prototype.EmptyInput=function(t){$(".add_admin_userBtn").on("click",function(){for(var e=0;e<t.length;e++)$(t[e]).find("input").val("")})},Common.prototype.setForm=function(){var t=new Date,e=t.getFullYear()+"-"+this.addZero(t.getMonth())+"-"+this.addZero(t.getDate()),n=t.getFullYear()+"-"+this.addZero(t.getMonth()+1)+"-"+this.addZero(t.getDate());return{from:e,to:n}},Common.prototype.setFormDate=function(){$("input[name=from]").attr("placeholder",this.setForm().from),$("input[name=to]").attr("placeholder",this.setForm().to)};var uiHelperTableToolsCheckable=function(){var t=jQuery(".js-table-checkable"),e=jQuery("#v-all-check");jQuery("input:checkbox",e).click(function(){var e=jQuery(this).prop("checked");this.bClick=!this.bClick,this.bClick?jQuery(this).closest("#v-all-check").addClass("active"):jQuery(this).closest("#v-all-check").removeClass("active"),jQuery("tbody input:checkbox",t).each(function(){var t=jQuery(this);t.prop("checked",e),uiHelperTableToolscheckRow(t,e)})}),jQuery("tbody input:checkbox",t).click(function(){var t=jQuery(this);uiHelperTableToolscheckRow(t,t.prop("checked"))}),jQuery("tbody > tr",t).click(function(t){if("checkbox"!==t.target.type&&"button"!==t.target.type&&"a"!==t.target.tagName.toLowerCase()&&!jQuery(t.target).parent("label").length){var e=jQuery("input:checkbox",this),n=e.prop("checked");console.log(!n),e.prop("checked",!n),uiHelperTableToolscheckRow(e,!n)}})},uiHelperTableToolscheckRow=function(t,e){e?t.closest("tr").addClass("active"):t.closest("tr").removeClass("active")};